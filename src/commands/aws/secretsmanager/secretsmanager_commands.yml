name: secretsmanager
help: Secrets Manager commands
group: Secrets Manager
expose: always
dependencies:
  aws: Install the latest version following the instructions at 'https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html'
  jq: Install using 'brew install jq'

commands:
  - name: list-secrets
    help: List all AWS Secrets Manager secrets
    filters:
      - profile_and_region_variables_set_with_flags
    flags:
      - import: src/components/aws/profile_flag.yml
      - import: src/components/aws/region_flag.yml
      - long: --detailed
        help: Output the list of all secrets in the detailed format

  - name: show-secret
    help: Show the secret value for the specified secret
    args:
      - name: secret_id
        required: true
        help: The secret ID for which the value needs to be displayed
    filters:
      - profile_and_region_variables_set_with_flags
    flags:
      - import: src/components/aws/profile_flag.yml
      - import: src/components/aws/region_flag.yml
      - long: --detailed
        help: Output the secret value in detailed format

  - name: create-secret
    help: Create a new secret in Secrets Manager
    filters:
      - profile_and_region_variables_set_with_flags
    flags:
      - import: src/components/aws/profile_flag.yml
      - import: src/components/aws/region_flag.yml
      - long: --name
        help: Name for the new secret
        required: true      
        arg: name
      - long: --secret-string
        help: The secret string to be stored
        required: true
        arg: secret_string
